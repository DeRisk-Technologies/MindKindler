(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9417],{11186:(e,s,a)=>{"use strict";a.d(s,{bq:()=>p,eb:()=>h,gC:()=>f,l6:()=>o,yv:()=>m});var t=a(95155),d=a(12115),r=a(95102),l=a(59007),i=a(42614),n=a(72251),c=a(64269);let o=r.bL;r.YJ;let m=r.WT,p=d.forwardRef((e,s)=>{let{className:a,children:d,...i}=e;return(0,t.jsxs)(r.l9,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[d,(0,t.jsx)(r.In,{asChild:!0,children:(0,t.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=r.l9.displayName;let u=d.forwardRef((e,s)=>{let{className:a,...d}=e;return(0,t.jsx)(r.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...d,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})});u.displayName=r.PP.displayName;let x=d.forwardRef((e,s)=>{let{className:a,...d}=e;return(0,t.jsx)(r.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...d,children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})});x.displayName=r.wn.displayName;let f=d.forwardRef((e,s)=>{let{className:a,children:d,position:l="popper",...i}=e;return(0,t.jsx)(r.ZL,{children:(0,t.jsxs)(r.UC,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,t.jsx)(u,{}),(0,t.jsx)(r.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:d}),(0,t.jsx)(x,{})]})})});f.displayName=r.UC.displayName,d.forwardRef((e,s)=>{let{className:a,...d}=e;return(0,t.jsx)(r.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...d})}).displayName=r.JU.displayName;let h=d.forwardRef((e,s)=>{let{className:a,children:d,...l}=e;return(0,t.jsxs)(r.q7,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.VF,{children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.p4,{children:d})]})});h.displayName=r.q7.displayName,d.forwardRef((e,s)=>{let{className:a,...d}=e;return(0,t.jsx)(r.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...d})}).displayName=r.wv.displayName},19476:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var t=a(95155),d=a(60796),r=a(3998),l=a(86948),i=a(32265),n=a(92033),c=a(69795),o=a(74640),m=a(13630),p=a(51834),u=a(76444),x=a(65142),f=a(11186),h=a(12115),j=a(15894),N=a(19708),g=a(14585),y=a(31120);function b(){var e,s,a;let{data:b,loading:w}=(0,d.$l)("departments","name","asc"),{data:v,loading:k}=(0,d.$l)("users","displayName","asc"),[A,C]=(0,h.useState)(!1),[D,z]=(0,h.useState)(!1),[R,I]=(0,h.useState)(null),{toast:T}=(0,j.dj)(),q=async e=>{e.preventDefault(),z(!0);let s=new FormData(e.currentTarget),a={name:s.get("name"),description:s.get("description"),headId:s.get("headId"),updatedAt:(0,N.serverTimestamp)()};try{R?(await (0,N.updateDoc)((0,N.doc)(g.db,"departments",R),a),T({title:"Updated",description:"Department updated."})):(await (0,N.addDoc)((0,N.collection)(g.db,"departments"),{...a,members:[],createdAt:(0,N.serverTimestamp)()}),T({title:"Created",description:"New department created."})),C(!1),I(null)}catch(e){T({title:"Error",description:e.message,variant:"destructive"})}finally{z(!1)}},E=async e=>{confirm("Are you sure? This will not delete the users inside.")&&await (0,N.deleteDoc)((0,N.doc)(g.db,"departments",e))};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-primary",children:"Departments & Groups"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Organize users into structural teams."})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)(p.lG,{open:A,onOpenChange:e=>{C(e),e||I(null)},children:[(0,t.jsx)(p.zM,{asChild:!0,children:(0,t.jsxs)(r.$,{children:[(0,t.jsx)(i.A,{className:"mr-2 h-4 w-4"})," Create Department"]})}),(0,t.jsxs)(p.Cf,{children:[(0,t.jsxs)(p.c7,{children:[(0,t.jsx)(p.L3,{children:R?"Edit Department":"New Department"}),(0,t.jsx)(p.rr,{children:"Define a new organizational unit."})]}),(0,t.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"name",children:"Department Name"}),(0,t.jsx)(x.p,{id:"name",name:"name",placeholder:"e.g. Clinical Services",required:!0,defaultValue:R?null==(e=b.find(e=>e.id===R))?void 0:e.name:""})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"description",children:"Description"}),(0,t.jsx)(y.T,{id:"description",name:"description",defaultValue:R?null==(s=b.find(e=>e.id===R))?void 0:s.description:""})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"headId",children:"Head of Department"}),(0,t.jsxs)(f.l6,{name:"headId",defaultValue:R?null==(a=b.find(e=>e.id===R))?void 0:a.headId:"",children:[(0,t.jsx)(f.bq,{children:(0,t.jsx)(f.yv,{placeholder:"Select User"})}),(0,t.jsxs)(f.gC,{children:[(0,t.jsx)(f.eb,{value:"none",children:"None"}),v.map(e=>(0,t.jsxs)(f.eb,{value:e.uid||e.id,children:[e.displayName," (",e.role,")"]},e.id))]})]})]}),(0,t.jsx)(p.Es,{children:(0,t.jsxs)(r.$,{type:"submit",disabled:D,children:[D&&(0,t.jsx)(n.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save"]})})]})]})]})}),(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.map(e=>(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[(0,t.jsx)(l.ZB,{className:"text-lg font-medium",children:e.name}),(0,t.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground mb-4",children:e.description||"No description"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Head:"}),(0,t.jsx)("span",{className:"font-medium",children:(e=>{let s=v.find(s=>s.id===e||s.uid===e);return s?s.displayName:"None"})(e.headId)})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Members:"}),(0,t.jsx)("span",{className:"font-medium",children:v.filter(s=>s.departmentId===e.id).length})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsxs)(r.$,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{I(e.id),C(!0)},children:[(0,t.jsx)(o.A,{className:"mr-2 h-3 w-3"})," Edit"]}),(0,t.jsx)(r.$,{variant:"ghost",size:"icon",className:"shrink-0 text-destructive",onClick:()=>E(e.id),children:(0,t.jsx)(m.A,{className:"h-4 w-4"})})]})]})]},e.id))})]})}},31120:(e,s,a)=>{"use strict";a.d(s,{T:()=>l});var t=a(95155),d=a(12115),r=a(64269);let l=d.forwardRef((e,s)=>{let{className:a,...d}=e;return(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...d})});l.displayName="Textarea"},65112:(e,s,a)=>{Promise.resolve().then(a.bind(a,19476))},69795:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(14294).A)("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]])}},e=>{e.O(0,[2992,3644,830,9308,1329,5872,9795,85,4098,8441,1255,7358],()=>e(e.s=65112)),_N_E=e.O()}]);