(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8876],{15894:(e,t,s)=>{"use strict";s.d(t,{dj:()=>u});var a=s(12115);let i=0,n=new Map,r=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=[],d={toasts:[]};function o(e){d=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?r(s):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(d,e),l.forEach(e=>{e(d)})}function c(e){let{...t}=e,s=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:s});return o({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function u(){let[e,t]=a.useState(d);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},26333:(e,t,s)=>{"use strict";s.d(t,{AM:()=>l,Wv:()=>d,hl:()=>o});var a=s(95155),i=s(12115),n=s(20561),r=s(64269);let l=n.bL,d=n.l9,o=i.forwardRef((e,t)=>{let{className:s,align:i="center",sideOffset:l=4,...d}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsx)(n.UC,{ref:t,align:i,sideOffset:l,className:(0,r.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...d})})});o.displayName=n.UC.displayName},45196:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>O});var a=s(95155),i=s(36385),n=s(983),r=s(31442),l=s(97081),d=s(60796),o=s(3998),c=s(86948),u=s(12115),m=s(51834),h=s(76444),p=s(65142),x=s(11186),f=s(31120),g=s(50276),v=s(26333),j=s(64269),y=s(71330),b=s(90109),w=s(27314),N=s(28127),S=s(92033),A=s(15894),T=s(3484),C=s(19708),_=s(14585);function I(e){let{children:t}=e,[s,i]=(0,u.useState)(!1),[n,r]=(0,u.useState)(1),[l,d]=(0,u.useState)(!1),[c,I]=(0,u.useState)(null),[k,O]=(0,u.useState)(""),[D,M]=(0,u.useState)([]),[E,P]=(0,u.useState)("consultation"),[U,z]=(0,u.useState)("video"),[G,$]=(0,u.useState)(void 0),[V,R]=(0,u.useState)(""),[F,W]=(0,u.useState)([]),[J,L]=(0,u.useState)(null),{toast:q}=(0,A.dj)(),B=async()=>{if(k){d(!0);try{let e=(0,C.query)((0,C.collection)(_.db,"users"),(0,C.where)("displayName",">=",k),(0,C.where)("displayName","<=",k+"ï£¿")),t=await (0,C.getDocs)(e);M(t.docs.map(e=>({id:e.id,...e.data()})))}catch(e){console.error(e)}finally{d(!1)}}},H=async()=>{if(c&&G){d(!0);try{var e;let t=(0,T.Uz)(void 0,"europe-west3"),s=(0,T.Qg)(t,"findAvailabilitySlots"),a=await s({participants:[null==(e=_.j2.currentUser)?void 0:e.uid,c.id],date:(0,y.GP)(G,"yyyy-MM-dd"),duration:60});a.data.slots&&a.data.slots.length>0?(W(a.data.slots),r(2)):q({title:"No slots found",description:"Try a different date.",variant:"destructive"})}catch(e){console.error(e),W(["09:00","10:00","14:00","15:30"]),r(2)}finally{d(!1)}}},Z=async()=>{if(J&&G&&c){d(!0);try{var e,t;let[s,a]=J.split(":"),n=new Date(G);n.setHours(parseInt(s),parseInt(a));let l=new Date(n);l.setHours(l.getHours()+1),await (0,C.addDoc)((0,C.collection)(_.db,"appointments"),{title:"".concat(E.charAt(0).toUpperCase()+E.slice(1)," with ").concat(c.displayName),participants:[null==(e=_.j2.currentUser)?void 0:e.uid,c.id],initiator:null==(t=_.j2.currentUser)?void 0:t.uid,reason:E,channel:U,startTime:n.toISOString(),endTime:l.toISOString(),status:"confirmed",createdByAI:!1,createdAt:(0,C.serverTimestamp)(),notes:V}),q({title:"Appointment Scheduled",description:"Invitations have been sent."}),i(!1),r(1),I(null),$(void 0),W([])}catch(e){console.error(e),q({title:"Error",description:"Failed to book appointment.",variant:"destructive"})}finally{d(!1)}}};return(0,a.jsxs)(m.lG,{open:s,onOpenChange:i,children:[(0,a.jsx)(m.zM,{asChild:!0,children:t}),(0,a.jsxs)(m.Cf,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsx)(m.L3,{children:"New Appointment"}),(0,a.jsx)(m.rr,{children:"Schedule a session with a student, parent, or colleague."})]}),1===n&&(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(h.J,{children:"Who is this with?"}),c?(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded-md bg-muted/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(w.A,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:c.displayName}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground capitalize",children:c.role})]})]}),(0,a.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>I(null),children:"Change"})]}):(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p.p,{placeholder:"Search by name...",value:k,onChange:e=>O(e.target.value),onKeyDown:e=>"Enter"===e.key&&B()}),(0,a.jsx)(o.$,{size:"icon",variant:"outline",onClick:B,disabled:l,children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]}),!c&&D.length>0&&(0,a.jsx)("div",{className:"border rounded-md mt-1 max-h-40 overflow-y-auto bg-background shadow-lg z-10",children:D.map(e=>(0,a.jsxs)("div",{className:"p-2 hover:bg-muted cursor-pointer flex items-center justify-between",onClick:()=>{I(e),M([])},children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.displayName}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.role})]},e.id))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(h.J,{children:"Reason"}),(0,a.jsxs)(x.l6,{value:E,onValueChange:P,children:[(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{})}),(0,a.jsxs)(x.gC,{children:[(0,a.jsx)(x.eb,{value:"consultation",children:"Consultation"}),(0,a.jsx)(x.eb,{value:"assessment",children:"Assessment"}),(0,a.jsx)(x.eb,{value:"therapy",children:"Therapy"}),(0,a.jsx)(x.eb,{value:"followUp",children:"Follow Up"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(h.J,{children:"Channel"}),(0,a.jsxs)(x.l6,{value:U,onValueChange:z,children:[(0,a.jsx)(x.bq,{children:(0,a.jsx)(x.yv,{})}),(0,a.jsxs)(x.gC,{children:[(0,a.jsx)(x.eb,{value:"video",children:"Video Call"}),(0,a.jsx)(x.eb,{value:"inPerson",children:"In Person"}),(0,a.jsx)(x.eb,{value:"phone",children:"Phone Call"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(h.J,{children:"Preferred Date"}),(0,a.jsxs)(v.AM,{children:[(0,a.jsx)(v.Wv,{asChild:!0,children:(0,a.jsxs)(o.$,{variant:"outline",className:(0,j.cn)("w-full justify-start text-left font-normal",!G&&"text-muted-foreground"),children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),G?(0,y.GP)(G,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(v.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(g.V,{mode:"single",selected:G,onSelect:$,initialFocus:!0,disabled:e=>e<new Date})})]})]})]}),2===n&&(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mb-2",children:["AI has found the following available slots for ",(0,y.GP)(G,"MMMM do")," based on both calendars:"]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:F.map(e=>(0,a.jsx)(o.$,{variant:J===e?"default":"outline",onClick:()=>L(e),className:"text-sm",children:e},e))}),(0,a.jsxs)("div",{className:"grid gap-2 mt-4",children:[(0,a.jsx)(h.J,{children:"Notes (Optional)"}),(0,a.jsx)(f.T,{placeholder:"Add agenda or details...",value:V,onChange:e=>R(e.target.value)})]})]}),(0,a.jsx)(m.Es,{children:1===n?(0,a.jsxs)(o.$,{onClick:H,disabled:!c||!G||l,children:[l&&(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Find Times"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.$,{variant:"outline",onClick:()=>r(1),children:"Back"}),(0,a.jsxs)(o.$,{onClick:Z,disabled:!J||l,children:[l&&(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirm Booking"]})]})})]})]})}var k=s(32265);function O(){let{data:e,loading:t}=(0,d.$l)("appointments"),{toast:s}=(0,A.dj)(),u=e.map(e=>({id:e.id,title:e.title||"Untitled",start:e.startTime,end:e.endTime,backgroundColor:"confirmed"===e.status?"#10b981":"#f59e0b",borderColor:"confirmed"===e.status?"#10b981":"#f59e0b",extendedProps:{...e}})),m=async e=>{try{var t;let{event:a}=e,i=a.start.toISOString(),n=(null==(t=a.end)?void 0:t.toISOString())||new Date(a.start.getTime()+36e5).toISOString();await (0,C.updateDoc)((0,C.doc)(_.db,"appointments",a.id),{startTime:i,endTime:n,status:"rescheduled"}),s({title:"Rescheduled",description:"Appointment time updated."})}catch(t){e.revert(),s({title:"Error",description:"Could not reschedule.",variant:"destructive"})}};return(0,a.jsxs)("div",{className:"space-y-6 p-8 pt-6 h-[calc(100vh-4rem)] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between shrink-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-primary",children:"Calendar & Appointments"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your schedule and consultations."})]}),(0,a.jsx)(I,{children:(0,a.jsxs)(o.$,{children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"})," New Appointment"]})})]}),(0,a.jsx)(c.Zp,{className:"flex-1 overflow-hidden",children:(0,a.jsx)(c.Wu,{className:"p-0 h-full",children:(0,a.jsx)("div",{className:"h-full p-4",children:(0,a.jsx)(i.A,{plugins:[n.A,r.A,l.Ay],initialView:"timeGridWeek",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},events:u,editable:!0,droppable:!0,selectable:!0,eventDrop:m,height:"100%",slotMinTime:"08:00:00",slotMaxTime:"18:00:00",allDaySlot:!1,nowIndicator:!0,eventClick:e=>{alert("Clicked: ".concat(e.event.title))}})})})})]})}},48911:(e,t,s)=>{Promise.resolve().then(s.bind(s,45196))},50276:(e,t,s)=>{"use strict";s.d(t,{V:()=>o});var a=s(95155);s(12115);var i=s(51190),n=s(63263),r=s(27548),l=s(64269),d=s(3998);function o(e){let{className:t,classNames:s,showOutsideDays:o=!0,...c}=e;return(0,a.jsx)(r.h,{showOutsideDays:o,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>{let{className:t,...s}=e;return(0,a.jsx)(i.A,{className:(0,l.cn)("h-4 w-4",t),...s})},IconRight:e=>{let{className:t,...s}=e;return(0,a.jsx)(n.A,{className:(0,l.cn)("h-4 w-4",t),...s})}},...c})}o.displayName="Calendar"}},e=>{e.O(0,[2992,3644,6018,830,9308,1329,5872,9795,85,1330,3484,4460,561,786,9091,8441,1255,7358],()=>e(e.s=48911)),_N_E=e.O()}]);